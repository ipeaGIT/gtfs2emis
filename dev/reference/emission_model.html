<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Emission model — emission_model • gtfs2emis</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Emission model — emission_model"><meta name="description" content="Estimate hot-exhaust emissions of public transport systems. This
function must be used together with transport_model."><meta property="og:description" content="Estimate hot-exhaust emissions of public transport systems. This
function must be used together with transport_model."><meta property="og:image" content="https://ipeagit.github.io/gtfs2emis/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gtfs2emis</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.1.1.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/gtfs2emis_emission_factor.html">Exploring Emission Factors</a></li>
    <li><a class="dropdown-item" href="../articles/gtfs2emis_fleet_data.html">Preparing fleet data for gtfs2emis</a></li>
    <li><a class="dropdown-item" href="../articles/gtfs2emis_intro_vignette.html">Getting started</a></li>
    <li><a class="dropdown-item" href="../articles/gtfs2emis_non_exhaust_ef.html">Exploring Non-Exhaust Emission Factors</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ipeaGIT/gtfs2emis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Emission model</h1>
      <small class="dont-index">Source: <a href="https://github.com/ipeaGIT/gtfs2emis/blob/master/R/emission_model.R" class="external-link"><code>R/emission_model.R</code></a></small>
      <div class="d-none name"><code>emission_model.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimate hot-exhaust emissions of public transport systems. This
function must be used together with <code><a href="transport_model.html">transport_model</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">emission_model</span><span class="op">(</span></span>
<span>  <span class="va">tp_model</span>,</span>
<span>  <span class="va">ef_model</span>,</span>
<span>  <span class="va">fleet_data</span>,</span>
<span>  <span class="va">pollutant</span>,</span>
<span>  reference_year <span class="op">=</span> <span class="fl">2020</span>,</span>
<span>  process <span class="op">=</span> <span class="st">"hot_exhaust"</span>,</span>
<span>  heightfile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ncores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  output_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  continue <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tp-model">tp_model<a class="anchor" aria-label="anchor" href="#arg-tp-model"></a></dt>
<dd><p>sf_linestring object or a character path the to sf_linestring objects.
The <code>tp_model</code> is the output from <code><a href="transport_model.html">transport_model</a></code>,
or the path in which the output files from the <code><a href="transport_model.html">transport_model</a></code> are saved.</p></dd>


<dt id="arg-ef-model">ef_model<a class="anchor" aria-label="anchor" href="#arg-ef-model"></a></dt>
<dd><p>character. A string indicating the emission factor model
to be used. Options include <code>ef_usa_moves</code>, <code>ef_usa_emfac</code>,<code>ef_europe_emep</code>,
,<code>ef_brazil_cetesb</code>, and <code>ef_brazil_scaled_euro</code> (scale <code><a href="ef_brazil_cetesb.html">ef_brazil_cetesb()</a></code> based
on <code><a href="ef_scaled_euro.html">ef_scaled_euro()</a></code>).</p></dd>


<dt id="arg-fleet-data">fleet_data<a class="anchor" aria-label="anchor" href="#arg-fleet-data"></a></dt>
<dd><p>data.frame. A <code>data.frame</code> with information the fleet
characteristics. The required columns depend on the
<code>ef_model</code> selection. See @examples for input.</p></dd>


<dt id="arg-pollutant">pollutant<a class="anchor" aria-label="anchor" href="#arg-pollutant"></a></dt>
<dd><p>character. Vector with one or more pollutants to be estimated.
Example: <code>c("CO", "CO2", "PM10", "NOx")</code>. See the documentation to check which
pollutants are available for each emission factor model (<code>ef_usa_moves</code>, <code>ef_usa_emfac</code>,
<code>ef_europe_emep</code>, or <code>ef_brazil_cetesb</code>).</p></dd>


<dt id="arg-reference-year">reference_year<a class="anchor" aria-label="anchor" href="#arg-reference-year"></a></dt>
<dd><p>numeric. Year of reference considered to calculate the
emissions inventory. Defaults to <code>2020</code>. This
argument is only required when the <code>ef_model</code>
parameter is <code>ef_usa_moves</code> or <code>ef_usa_emfac</code>.</p></dd>


<dt id="arg-process">process<a class="anchor" aria-label="anchor" href="#arg-process"></a></dt>
<dd><p>character; Emission process, classified in "hot_exhaust" (Default),
and wear processes (identified as "tyre","brake" and/or "road" wear).
Note that wear processes are only available when the <code>ef_europe_emep</code> is
selected in the @param ef_model. Details on wear emissions are presented in
<code><a href="emi_europe_emep_wear.html">emi_europe_emep_wear</a></code>.</p></dd>


<dt id="arg-heightfile">heightfile<a class="anchor" aria-label="anchor" href="#arg-heightfile"></a></dt>
<dd><p>character or raster data. The raster file with height data,
or its filepath, used to estimate emissions considering the effect of
street slope. This argument is used only when <code>ef_brazil_scaled_euro</code> or
<code>ef_europe_emep</code> are selected. Default is <code>NULL</code>. Details are provided in
<code><a href="slope_class_europe_emep.html">slope_class_europe_emep</a></code>.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>logical. Decides whether the function should run in parallel.
Defaults is <code>TRUE</code>.</p></dd>


<dt id="arg-ncores">ncores<a class="anchor" aria-label="anchor" href="#arg-ncores"></a></dt>
<dd><p>integer. Number of cores to be used in parallel execution. This
argument is ignored if parallel is <code>FALSE</code>. Default (<code>NULL</code>) selects
the total number of available cores minus one.</p></dd>


<dt id="arg-output-path">output_path<a class="anchor" aria-label="anchor" href="#arg-output-path"></a></dt>
<dd><p>character. File path where the function output is exported.
If <code>NULL</code> (Default), the function returns the output to user.</p></dd>


<dt id="arg-continue">continue<a class="anchor" aria-label="anchor" href="#arg-continue"></a></dt>
<dd><p>logical. Argument that can be used only with output_path When TRUE,
it skips processing the shape identifiers that were already saved into
files. It is useful to continue processing a GTFS file that was stopped
for some reason. Default value is FALSE.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>Logical; Display messages from the emissions or emission factor functions.
Default is 'TRUE'.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>list</code> with emissions estimates or <code>NULL</code> with output files saved
locally at <code>output_path</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>fleet_data</code> must be a <code>data.frame</code> organized according to the desired
<code>ef_model</code>. The required columns is organized as follows (see @examples for real
data usage).</p><ul><li><p><code>veh_type</code>: character; Bus type, classified according to the @param ef_model .
For <code>ef_emep_europe</code>, use "Ubus Midi &lt;=15 t","Ubus Std 15 - 18 t",
"Ubus Artic &gt;18 t", "Coaches Std &lt;=18 t" or "Coaches Artic &gt;18 t"; For
<code>ef_usa_moves</code> or <code>ef_usa_emfac</code>, use "BUS_URBAN_D"; For <code>ef_brazil_cetesb</code>,
use "BUS_URBAN_D", "BUS_MICRO_D", "BUS_COACH_D" or "BUS_ARTIC_D".</p></li>
<li><p><code>type_name_eu</code>: character; Bus type, used only for @param ef_model <code>ef_scaled_euro</code>
are selected. The classes can be "Ubus Midi &lt;=15 t","Ubus Std 15 - 18 t",
"Ubus Artic &gt;18 t", "Coaches Std &lt;=18 t" or "Coaches Artic &gt;18 t".</p></li>
<li><p><code>reference_year</code>: character; Base year of the emission factor model input.
Required only when  <code>ef_usa_moves</code> or <code>ef_usa_emfac</code> are selected.</p></li>
<li><p><code>tech</code>: character; After treatment technology. This is required only
when <code>emep_europe</code> is selected. Check <code>?ef_emep_europe</code> for details.</p></li>
<li><p><code>euro</code>: character; Euro period of vehicle, classified in
"Conventional", "I", "II", "III", "IV", "V", "VI", and "EEV". This is required only
when <code>ef_emep_europe</code> is selected. Check <code>ef_europe_emep</code> for details.</p></li>
<li><p><code>fuel</code>: character; Required when <code>ef_usa_moves</code>, <code>ef_usa_emfac</code> and
<code>ef_europe_emep</code> are selected.</p></li>
<li><p><code>fleet_composition</code>: Numeric. Scaled composition of fleet. In most
cases, the user might not know which vehicles run on each specific routes.
The composition is used to attribute a probability of a specific vehicle to
circulate in the line. The probability sums one. Required for all emission
factors selection.
Users can check the <a href="https://ipeagit.github.io/gtfs2emis/articles/gtfs2emis_fleet_data.html">gtfs2emis fleet data vignette</a>,
for more examples.</p></li>
</ul><p>Based on the input height data, the function returns the slope class between
two consecutive bus stop positions of a LineString Simple Feature
(transport model object). The slope is given by the ratio between the height
difference and network distance from two consecutive public transport stops.
The function classifies the slope into one of the seven categories
available on the European Environmental Agency (EEA) database, which is -0.06,
-0.04,-0.02, 0.00, 0.02, 0.04, and 0.06.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Core function:
<code><a href="transport_model.html">transport_model()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"gtfstools"</span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># read GTFS</span></span></span>
<span class="r-in"><span><span class="va">gtfs_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/bra_cur_gtfs.zip"</span>, package <span class="op">=</span> <span class="st">"gtfs2emis"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gtfs</span> <span class="op">&lt;-</span> <span class="fu">gtfstools</span><span class="fu">::</span><span class="fu"><a href="https://ipeagit.github.io/gtfstools/reference/read_gtfs.html" class="external-link">read_gtfs</a></span><span class="op">(</span><span class="va">gtfs_file</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># keep a single trip_id to speed up this example</span></span></span>
<span class="r-in"><span><span class="va">gtfs_small</span> <span class="op">&lt;-</span> <span class="fu">gtfstools</span><span class="fu">::</span><span class="fu"><a href="https://ipeagit.github.io/gtfstools/reference/filter_by_trip_id.html" class="external-link">filter_by_trip_id</a></span><span class="op">(</span><span class="va">gtfs</span>, trip_id <span class="op">=</span><span class="st">"4451136"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="co"># run transport model</span></span></span>
<span class="r-in"><span><span class="va">tp_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="transport_model.html">transport_model</a></span><span class="op">(</span>gtfs_data <span class="op">=</span> <span class="va">gtfs_small</span>,</span></span>
<span class="r-in"><span>                            min_speed <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                            max_speed <span class="op">=</span> <span class="fl">80</span>,</span></span>
<span class="r-in"><span>                            new_speed <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>                            spatial_resolution <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>                            parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example using Brazilian emission model and fleet</span></span></span>
<span class="r-in"><span><span class="va">fleet_data_ef_cetesb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>veh_type <span class="op">=</span> <span class="st">"BUS_URBAN_D"</span>,</span></span>
<span class="r-in"><span>                                   model_year <span class="op">=</span> <span class="fl">2010</span><span class="op">:</span><span class="fl">2019</span>,</span></span>
<span class="r-in"><span>                                   fuel <span class="op">=</span> <span class="st">"D"</span>,</span></span>
<span class="r-in"><span>                                   fleet_composition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                   <span class="op">)</span></span></span>
<span class="r-in"><span>                                   </span></span>
<span class="r-in"><span><span class="va">emi_cetesb</span> <span class="op">&lt;-</span> <span class="fu">progressr</span><span class="fu">::</span><span class="fu"><a href="https://progressr.futureverse.org/reference/with_progress.html" class="external-link">with_progress</a></span><span class="op">(</span><span class="fu">emission_model</span><span class="op">(</span></span></span>
<span class="r-in"><span>                tp_model <span class="op">=</span> <span class="va">tp_model</span>,</span></span>
<span class="r-in"><span>                ef_model <span class="op">=</span> <span class="st">"ef_brazil_cetesb"</span>,</span></span>
<span class="r-in"><span>                fleet_data <span class="op">=</span> <span class="va">fleet_data_ef_cetesb</span>,</span></span>
<span class="r-in"><span>                pollutant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CO"</span>,<span class="st">"PM10"</span>,<span class="st">"CO2"</span>,<span class="st">"CH4"</span>,<span class="st">"NOx"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                            </span></span>
<span class="r-in"><span><span class="co"># Example using European emission model and fleet</span></span></span>
<span class="r-in"><span><span class="va">fleet_data_ef_europe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>  veh_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ubus Midi &lt;=15 t"</span>,</span></span>
<span class="r-in"><span>                                                  <span class="st">"Ubus Std 15 - 18 t"</span>,</span></span>
<span class="r-in"><span>                                                  <span class="st">"Ubus Artic &gt;18 t"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                   , euro <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"III"</span>,<span class="st">"IV"</span>,<span class="st">"V"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                   , fuel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"D"</span>,<span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                   , tech <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-"</span>,<span class="st">"SCR"</span>,<span class="st">"SCR"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                   , fleet_composition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                   </span></span>
<span class="r-in"><span><span class="va">emi_emep</span> <span class="op">&lt;-</span> <span class="fu">progressr</span><span class="fu">::</span><span class="fu"><a href="https://progressr.futureverse.org/reference/with_progress.html" class="external-link">with_progress</a></span><span class="op">(</span><span class="fu">emission_model</span><span class="op">(</span>tp_model <span class="op">=</span> <span class="va">tp_model</span></span></span>
<span class="r-in"><span>                          , ef_model <span class="op">=</span> <span class="st">"ef_europe_emep"</span></span></span>
<span class="r-in"><span>                          , fleet_data <span class="op">=</span> <span class="va">fleet_data_ef_europe</span></span></span>
<span class="r-in"><span>                          , pollutant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PM10"</span>,<span class="st">"NOx"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">emi_emep_wear</span> <span class="op">&lt;-</span> <span class="fu">progressr</span><span class="fu">::</span><span class="fu"><a href="https://progressr.futureverse.org/reference/with_progress.html" class="external-link">with_progress</a></span><span class="op">(</span><span class="fu">emission_model</span><span class="op">(</span>tp_model <span class="op">=</span> <span class="va">tp_model</span></span></span>
<span class="r-in"><span>                          , ef_model <span class="op">=</span> <span class="st">"ef_europe_emep"</span></span></span>
<span class="r-in"><span>                          , fleet_data <span class="op">=</span> <span class="va">fleet_data_ef_europe</span></span></span>
<span class="r-in"><span>                          , pollutant <span class="op">=</span> <span class="st">"PM10"</span></span></span>
<span class="r-in"><span>                          , process <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tyre"</span>,<span class="st">"road"</span>,<span class="st">"brake"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">raster_cur</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/bra_cur-srtm.tif"</span>, package <span class="op">=</span> <span class="st">"gtfs2emis"</span><span class="op">)</span>                           </span></span>
<span class="r-in"><span><span class="va">emi_emep_slope</span> <span class="op">&lt;-</span> <span class="fu">progressr</span><span class="fu">::</span><span class="fu"><a href="https://progressr.futureverse.org/reference/with_progress.html" class="external-link">with_progress</a></span><span class="op">(</span><span class="fu">emission_model</span><span class="op">(</span>tp_model <span class="op">=</span> <span class="va">tp_model</span></span></span>
<span class="r-in"><span>                          , ef_model <span class="op">=</span> <span class="st">"ef_europe_emep"</span></span></span>
<span class="r-in"><span>                          , fleet_data <span class="op">=</span> <span class="va">fleet_data_ef_europe</span></span></span>
<span class="r-in"><span>                          , heightfile <span class="op">=</span> <span class="va">raster_cur</span></span></span>
<span class="r-in"><span>                          , pollutant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PM10"</span>,<span class="st">"NOx"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  </span></span>
<span class="r-in"><span>                                                  </span></span>
<span class="r-in"><span><span class="co"># Example using US EMFAC emission model and fleet</span></span></span>
<span class="r-in"><span><span class="va">fleet_data_ef_moves</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>  veh_type <span class="op">=</span> <span class="st">"BUS_URBAN_D"</span></span></span>
<span class="r-in"><span>                                  , model_year <span class="op">=</span> <span class="fl">2010</span><span class="op">:</span><span class="fl">2019</span></span></span>
<span class="r-in"><span>                                  , fuel <span class="op">=</span> <span class="st">"D"</span></span></span>
<span class="r-in"><span>                                  , reference_year <span class="op">=</span> <span class="fl">2020</span></span></span>
<span class="r-in"><span>                                  , fleet_composition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                  </span></span>
<span class="r-in"><span><span class="va">fleet_data_ef_emfac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>  veh_type <span class="op">=</span>  <span class="st">"BUS_URBAN_D"</span></span></span>
<span class="r-in"><span>                                  , model_year <span class="op">=</span> <span class="fl">2010</span><span class="op">:</span><span class="fl">2019</span></span></span>
<span class="r-in"><span>                                  , fuel <span class="op">=</span> <span class="st">"D"</span></span></span>
<span class="r-in"><span>                                  , reference_year <span class="op">=</span> <span class="fl">2020</span></span></span>
<span class="r-in"><span>                                  , fleet_composition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                                  </span></span>
<span class="r-in"><span><span class="co"># Example using US MOVES emission model and fleet</span></span></span>
<span class="r-in"><span><span class="va">emi_moves</span> <span class="op">&lt;-</span> <span class="fu">emission_model</span><span class="op">(</span>tp_model <span class="op">=</span> <span class="va">tp_model</span></span></span>
<span class="r-in"><span>                          , ef_model <span class="op">=</span> <span class="st">"ef_usa_moves"</span></span></span>
<span class="r-in"><span>                          , fleet_data <span class="op">=</span> <span class="va">fleet_data_ef_moves</span></span></span>
<span class="r-in"><span>                          , pollutant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CO"</span>,<span class="st">"PM10"</span>,<span class="st">"CO2"</span>,<span class="st">"CH4"</span>,<span class="st">"NOx"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                          , reference_year <span class="op">=</span> <span class="fl">2020</span><span class="op">)</span></span></span>
<span class="r-in"><span>                          </span></span>
<span class="r-in"><span><span class="va">emi_emfac</span> <span class="op">&lt;-</span> <span class="fu">emission_model</span><span class="op">(</span>tp_model <span class="op">=</span> <span class="va">tp_model</span></span></span>
<span class="r-in"><span>                          , ef_model <span class="op">=</span> <span class="st">"ef_usa_emfac"</span></span></span>
<span class="r-in"><span>                          , fleet_data <span class="op">=</span> <span class="va">fleet_data_ef_emfac</span></span></span>
<span class="r-in"><span>                          , pollutant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CO"</span>,<span class="st">"PM10"</span>,<span class="st">"CO2"</span>,<span class="st">"CH4"</span>,<span class="st">"NOx"</span><span class="op">)</span></span></span>
<span class="r-in"><span>                          , reference_year <span class="op">=</span> <span class="fl">2020</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Converting shapes to sf objects</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Processing the data</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Constant emission factor along the route</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joao Bazzo, Rafael H. M. Pereira, Pedro R. Andrade, Ipea - Institute for Applied Economic Research.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

